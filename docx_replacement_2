using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using SautinSoft.Document;

namespace Find_Text
{
    class Program
    {
        static void Main(string[] args)
        {
           // List<string> filesPaths = new List<string>();

            string fileName = "Prilojenie1";

            string pathDirectoy= @"D:\Applications_Yuli\Program_2.089\";        
            string fileFormat = ".docx";
            string pathApplication = pathDirectoy + fileName +  fileFormat;

            string pathApplicatinResult= pathDirectoy +fileName+ "_filled" + fileFormat;
            
            Dictionary<int, string> components = new Dictionary<int, string>();
            components.Add(101, "Име");
            components.Add(102, "Презиме");
            components.Add(103, "Фамилия");
            components.Add(104, "Управител");
            components.Add(105, "Фирма");
            components.Add(106, "ЕИК");
            components.Add(107, "№ проектно предложение");
            components.Add(108, "ЕГН");
            components.Add(109, "имейл");
            components.Add(110, "Телефон");
            components.Add(111, "дата на подписване");
            components.Add(112, "Фирмено седалище");
            components.Add(113, "Наименование на проекта");



            FindAndReplace(components, pathApplication, pathApplicatinResult);
                      
        }

        private static void FindAndReplace(Dictionary<int, string> components, string pathApplication, string pathApplicatinResult)
        {

            DocumentCore dc = DocumentCore.Load(pathApplication);

            foreach (var component in components)
            {
                foreach (Paragraph par in dc.GetChildElements(true, ElementType.Paragraph))
                    foreach (ContentRange items in par.Content.Find(component.Key.ToString()).Reverse())
                    {
                        items.Replace(component.Value.ToString());
                    }
            }

            dc.Save(pathApplicatinResult);
           
        }

      




      

        
    }
}
